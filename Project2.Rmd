---
title: "Project2"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Name: Pranav Varanasi
UTEID: ptv247
Date: 4/21/2021

## R Markdown

Title: How do we get power?

Part 1: Introduction

As recently experienced with the Texas snowstorms, the reliability and efficiency of the energy grid is crucial to maintaining a basic quality of life for an individual.
Issues with power can cause widespread chaos and quickly shut down the fundamental functions of modern society. The key issue made relevant by these Texas storms is the impact of climate change and the need for a continued reliance on renewable energy. With this issue in mind, I became curious as to the main sources of power running all the states across the country. In addition, I began to wonder how much of the country had already transitioned to renewable energy sources like solar, wind, and geothermal and how many states still had a majority dependence on non-renewable sources like natural gas and coal. Throughout the course of this project, I hope to identify which states and regions are most reliant on forms of renewable energy and understand how much of the energy grid needs to transition in order to make the majority of the country reliant on green power. I expect that policies surrounding renewable energy are politically driven and that the West coast region and states with heavy Democratic interests will be more reliant on renewable energy than the rest of the country. I also hope to identify associations between how much a reliance on specific types of non-renewable energy (e.g. natural gas, oil) affects which renewable energy sources are chosen to transition to within certain geographic regions.


To answer these questions, I chose two datasets that together provide the energy sources by state from 1960 - 2014 as well as region/division identifiers for each state. 
The main advantage I have in grouping these two datasets is to be able to group states by region and identify the main sources of energy. 

More information about these datasets can be found below:

Dataset 1: Energy.csv 
- Provides energy sources by state from 1960 - 2014
- Sources: 
- https://corgis-edu.github.io/corgis/csv/energy/
- https://www.eia.gov/tools/faqs/

Dataset 2: usa_states.csv 
- Provides abbreviations and region/division identifiers for each state
- Source: 
- Inbuilt R-dataset from "stevedata" library
- https://vincentarelbundock.github.io/Rdatasets/datasets.html

Part 2: Import + Tidy + Merge
```{r}

# Set working directory to local
#setwd('/Users/pranavvaranasi/Desktop/')

# Import stevedata for in-built usa_states dataset
library(stevedata)

# Import tidyverse and dplyr operations
library(tidyverse)
library(dplyr)

# Read in online energy data from 1960 - 2014 and save as dataframe
energyData <- read_csv("energy.csv")

# Clean datasets:
# Both datasets are already TIDY since each observation has its own row and each variable has its own column

# Dataset 1: Energy.csv
# Drop all Production, Expenditure, and Price columns from energyData
# Only want columns for Consumption across different sectors, Commercial, Electric Power, Industrial, Refinery, Residential, and Transportation

energyTrimmed <- energyData %>%  select(-"Production.Coal") %>% select(-"Expenditure.Commercial.Coal") %>% select(-"Expenditure.Commercial.Distillate Fuel Oil") %>%  select(-"Expenditure.Commercial.Kerosene") %>% select(-"Expenditure.Commercial.Liquefied Petroleum Gases") %>% select(-"Expenditure.Commercial.Natural Gas") %>%  select(-"Expenditure.Electric Power.Coal") %>% select(-"Expenditure.Electric Power.Distillate Fuel Oil") %>% select(-"Expenditure.Electric Power.Natural Gas") %>% select(-"Expenditure.Industrial.Coal") %>%  select(-"Expenditure.Industrial.Distillate Fuel Oil") %>% select(-"Expenditure.Industrial.Kerosene") %>% select(-"Expenditure.Industrial.Liquefied Petroleum Gases") %>% select(-"Expenditure.Industrial.Natural Gas") %>% select(-"Expenditure.Industrial.Other Petroleum Products") %>%  select(-"Expenditure.Residential.Coal") %>% select(-"Expenditure.Residential.Distillate Fuel Oil") %>% select(-"Expenditure.Residential.Kerosene") %>% select(-"Expenditure.Residential.Liquefied Petroleum Gases") %>%  select(-"Expenditure.Residential.Natural Gas") %>% select(-"Expenditure.Residential.Wood") %>%  select(-"Expenditure.Transportation.Coal") %>% select(-"Expenditure.Transportation.Distillate Fuel Oil") %>% select(-"Expenditure.Transportation.Liquefied Petroleum Gases") %>% select(-"Expenditure.Transportation.Natural Gas") %>%  select(-"Price.Commercial.Coal") %>% select(-"Price.Commercial.Distillate Fuel Oil") %>% select(-"Price.Commercial.Kerosene") %>% select(-"Price.Commercial.Liquefied Petroleum Gases") %>%  select(-"Price.Commercial.Natural Gas")  %>% select(-"Price.Electric Power.Coal") %>% select(-"Price.Electric Power.Distillate Fuel Oil") %>%  select(-"Price.Electric Power.Natural Gas") %>% select(-"Price.Industrial.Coal") %>% select(-"Price.Industrial.Distillate Fuel Oil") %>% select(-"Price.Industrial.Kerosene") %>%  select(-"Price.Industrial.Liquefied Petroleum Gases") %>% select(-"Price.Industrial.Natural Gas") %>%  select(-"Price.Industrial.Other Petroleum Products") %>% select(-"Price.Transportation.Coal") %>% select(-"Price.Transportation.Distillate Fuel Oil") %>% select(-"Price.Transportation.Liquefied Petroleum Gases") %>%  select(-"Price.Transportation.Natural Gas") 


# Create new variables/columns to represent total renewable and total non-renewable energy per year for each state
# Renewable Energy Types: Geothermal, Hydropower, Solar, Wind, Wood
# Non-Renewable Energy Types: Coal, Distillate Fuel Oil, Kerosene, Liqueified Petroleum Gases, Natural Gas

# Sum up all non-renewable energy sources and save them in one column, units are in billions of BTU (British Thermal Unit)
# Move column to front of dataframe with .before operator
energySum <- energyTrimmed %>% mutate(nonRenewableTotal = Consumption.Commercial.Coal  + `Consumption.Commercial.Distillate Fuel Oil` + Consumption.Commercial.Kerosene +  `Consumption.Commercial.Liquefied Petroleum Gases` + 
`Consumption.Commercial.Natural Gas` + `Consumption.Electric Power.Coal` + `Consumption.Electric Power.Distillate Fuel Oil` +
`Consumption.Electric Power.Natural Gas` + Consumption.Industrial.Coal + `Consumption.Industrial.Distillate Fuel Oil` + Consumption.Industrial.Kerosene + `Consumption.Industrial.Liquefied Petroleum Gases` + `Consumption.Industrial.Natural Gas` + `Consumption.Industrial.Other Petroleum Products`  + Consumption.Refinery.Coal + `Consumption.Refinery.Distillate Fuel Oil` +  `Consumption.Refinery.Liquefied Petroleum Gases` + `Consumption.Refinery.Natural Gas` +  Consumption.Residential.Coal + `Consumption.Residential.Distillate Fuel Oil` + Consumption.Residential.Kerosene + `Consumption.Residential.Liquefied Petroleum Gases` + `Consumption.Residential.Natural Gas` + Consumption.Transportation.Coal 
+ `Consumption.Transportation.Distillate Fuel Oil` + `Consumption.Transportation.Liquefied Petroleum Gases` + `Consumption.Transportation.Natural Gas`, .before = Consumption.Commercial.Coal)


# Sum up all reneable energy sources, put renewable column before nonRenewable column
# Save fully formatted dataset as energyClean
energyClean <- energySum %>% mutate(renewableTotal = Consumption.Commercial.Geothermal + Consumption.Commercial.Hydropower + Consumption.Commercial.Solar + Consumption.Commercial.Wind + Consumption.Commercial.Wood + 
`Consumption.Electric Power.Wood` + Consumption.Industrial.Geothermal + Consumption.Industrial.Hydropower + Consumption.Industrial.Solar + Consumption.Industrial.Wind + Consumption.Industrial.Wood
 + Consumption.Residential.Geothermal + Consumption.Residential.Wood, .before = nonRenewableTotal)


# Dataset 2: usa_states.csv
# Dataset 2 is already in proper ascending order by state and has all relevant columns

# Rename statename variable so it matches up with energy dataset
renameStates <- usa_states %>% rename('State' = statename)

# Perform left join with energy clean dataset
energyJoin <- energyClean %>% left_join(renameStates, by = 'State')


# Sort dataframe in ascending order of state names
# Sorting is needed to group all data for one state together and make overall table visually understandable
energyJoin <- energyJoin %>% arrange(State)

# Add a percent renewable variable for each state
energyJoin <- energyJoin %>% mutate(percentRenewable = (renewableTotal / (renewableTotal + nonRenewableTotal)) * 100, .before = renewableTotal)


```
My combined dataset, energyJoin, has 2805 observations for each of the 50 states across the time period from 1960 - 2014. 
From these, I chose to focus specifically on the numeric variables corresponding to types of non-renewable and renewable energy consumption.
I also added 3 numeric variables (percentRenewable, nonRenewableTotal, renewableTotal) from this consumption data for easier analysis.
Each individual dataset was already in tidy form where each observation has its own row and each variable has its own column.
I expect to identify mean differences in the total percentage and types of renewable energy reliance across the 4 U.S. geographic regions (South, West, North-central, Northeast)



Part 2: EDA

```{r}

# Plot 1: Correlation Matrix

# Only keep variables for Consumption commercial since commercial sector is biggest area to use energy
# Out of commercial variables, keep biggest producers of Coal, Petrol, Natural Gas, Solar, Wind, Wood
energyMap <- energyJoin %>% select(-State) %>% select(-Year) %>% select(Consumption.Commercial.Coal,`Consumption.Commercial.Liquefied Petroleum Gases`, `Consumption.Commercial.Natural Gas`, Consumption.Commercial.Solar, Consumption.Commercial.Wind, Consumption.Commercial.Wood)
 
# Source: Lab 4
cor(energyMap) %>%
  # Save as a data frame
  as.data.frame %>%
  # Convert row names to an explicit variable
  rownames_to_column %>%
  # Pivot so that all correlations appear in the same column
  pivot_longer(-1, names_to = "other_var", values_to = "correlation") %>%
  # Specify variables are displayed alphabetically from top to bottom
  ggplot(aes(rowname, factor(other_var, levels = rev(levels(factor(other_var)))), fill=correlation)) +
  # Heatmap with geom_tile
  geom_tile() +
  # Change the scale to make the middle appear neutral
  scale_fill_gradient2(low="red",mid="white",high="blue") +
  # Overlay values
  geom_text(aes(label = round(correlation,2)), color = "black", size = 4) +
  # Give title and labels
  labs(title = "Correlation matrix for Consumption Factors", x = "", y = "") 


# Plot 2: region on x, percent renewable on y, barplot, decrease x axis size with theme for visual purposes
plot <- ggplot(data = energyJoin,  aes(x= State, y=percentRenewable, fill = region)) + geom_bar(stat = 'summary', fun = 'mean') + scale_fill_brewer(palette = "Spectral") + geom_errorbar(stat = 'summary', fun.data = 'mean_se', width = 0.5) +  theme(axis.text.x=element_text(size = 2))
  
# Add a title and label axes
plot + ggtitle("Percent Renewable Energy Consumption by Region (1960-2014)") + xlab("State") + ylab("Percent Renewable Energy Consumption")


```


My correlation heat map shows relatively strong relationships between consumption of natural gas and wood as well as consumption of natural gas and petroleum gas.
The relationship between natural gas and wood is surprising as we usually expect an inverse relationship between renewable and non-renewable energy.
The relationship between the two types of gas is expected as fossil fuels can have a co-dependence on each other and can be intermixed as an energy source.
Based on this heatmap, I hope to understand how reliance on a specific renewable or non-renewable resource affects the overall percentage renewable that is generated.
The heatmap also shows poor correrlations between energy sources of the same type (e.g wood and solar). I hope to investigate this difference to see how renewable sources differ across the country.

My percent renewable energy consumption plot shows a clear difference in the renewable energy reliance between regions over the years.
Based on this, I will investigate the differences in percentageRenweable, and consumption of solar energy with my ANOVA tests.
I specifically picked consumption of solar energy to calculate differences for since it is the most likely to vary by region across the US.


Part 3: MANOVA
```{r}

# Source : WS13

# Check Assumptions:

# Group percentRenewable, consumption solar across different regions
energyJoin %>%
  group_by(region) %>%
  summarize(mean(percentRenewable), mean(Consumption.Commercial.Solar))


# Represent the means per region in graph
# Checks random sample, independent observations based on diff means:
energyJoin %>%
  select(region, percentRenewable, Consumption.Commercial.Solar) %>%
  pivot_longer(-1,names_to='DV', values_to='measure') %>%
  ggplot(aes(region,measure,fill=region)) +
  geom_bar(stat="summary", fun = "mean") +
  geom_errorbar(stat="summary", fun.data = "mean_se", width=.5) +
  facet_wrap(~DV, nrow=2) +
  coord_flip() + 
  ylab("") + 
  theme(legend.position = "none")

# Inspect multivariate plots of response variable for each region
# Checks normality of response variables assumption:
ggplot(energyJoin, aes(x = percentRenewable, y = Consumption.Commercial.Solar)) +
  geom_point(alpha = .5) + 
  geom_density_2d(h=2) + 
  facet_wrap(~region)

# Inspect homogeneity of (co)variances
covmats <- energyJoin %>%
  group_by(region) %>%
  do(covs=cov(.[2:4]))

# Covariance matrices per 4 regions
for(i in 1:4){print(as.character(covmats$region[i])); print(covmats$covs[i])}

```

I checked the assumptions of random sample/independence, multivariate normality, and homogeneity of covariances with a bar plot, scatterplot, and co-variance matrix.
Of these, only the random sample/independence assumption looks to be met given the observed mean difference between regions. The homogeneity of co-variances doesn't look to be met
as the relative coefficents across regions are not similar. The multivariate normality assumption is also not met due to the overwhelming presence of many multivariate outliers.
However, there does not appear to be multicollinearity between the different response variables.


```{r}

# Perform MANOVA with 2 response variables listed in cbind()
manova_energy <- manova(cbind(percentRenewable,Consumption.Commercial.Solar) ~ region, data = energyJoin)

# Output of MANOVA, approx F is pseudo F-staistic, if p-value is very small, means significant diff across groups for atleast one of these variables
summary(manova_energy)

# If MANOVA is significant then we can perform one-way ANOVA for each variable, p-value here tells you which response variables are significantly different
summary.aov(manova_energy)

# Conduct paired t-tests to see which groups are actually different

# If ANOVA is significant then we can perform post-hoc analysis

# For percentRenewable, p-values here tell you between which groups there actually is a diff
# Apply bonferoni correction
pairwise.t.test(energyJoin$percentRenewable,energyJoin$region, p.adj="bonf")

# For solar consumption
pairwise.t.test(energyJoin$Consumption.Commercial.Solar,energyJoin$region, p.adj="bonf")
    

```

Null Hypothesis: Mean percent renwable and mean solar energy consumption are same across different regions
Alternate Hypothesis: Either Mean percent renwable and/pr mean solar energy consumption are different across different regions

For my overall ANOVA analysis, I conducted 12 t-tests, 2 one-way ANOVAS, and 1 MANOVA to generate a total of 15 p-values.
From these tests, I calculated the probability of atleast one type 1 error as 1 - 0.95^15 = 0.5368.
I also used the Bonferroni correction with a Bonferroni value of 0.05 / 15 = 0.0033 to identify the significant results below:

After conducting the MANOVA test, I found that both percent renwable and solar energy consumption had low p-values.
This led me to conclude there is a significant difference for these values across region and conduct post-hoc t tests.

However, when I conducted one-way ANOVA and pairwise t-tests I found that only percent renewable had a significant difference WITHIN all of the regions.
Solar energy consumption had high p-values and didn't have a large difference within each geographic region even though it had a significant difference
across regions.



Part 4: PERMANOVA Randomization Test

```{r}

# Source: WS13

# The package vegan contains a function for performing PERMANOVA
library(vegan)

# Compute Euclidean distances between observations of percent and solalr
dists <- energyJoin %>%
  select(percentRenewable, Consumption.Commercial.Solar) %>%
  dist

# Perform PERMANOVA on the distance matrix, end p-value is significant shows atleast one of the responses differ across regions
adonis(dists ~ region, data = energyJoin)

```
Null Hypothesis: Mean percent renwable and mean solar energy consumption are same across different regions
Alternate Hypothesis: Either Mean percent renwable and/pr mean solar energy consumption are different across different regions

After conducting the permanova test, I got a observed F-statistic oof 8.063 and a p-value of 0.001.
Since this p-value is very small and below 0.05, I canreject the null hypotheses and say that atleast one numeric variable has a 
significant difference in mean across the regions.
 


```{r}
# Source: WS13

# Create plot visualizaing null distribution and test statistic

# Observed F-statistic calculated from above permanova
obs_F <- 8.0603

# Randomization test (using replicate)
Fs <- replicate(5000,{
  
  # Randomly permute the response variable across regions
  new <- energyJoin %>%
    mutate(percentRenew = sample(percentRenewable))
  
  # Compute variation within groups
  SSW <- new %>%
    group_by(region) %>%
    summarize(SSW = sum((percentRenew - mean(percentRenew))^2)) %>%
    summarize(sum(SSW)) %>% 
    pull
  
  # Compute variation between groups
  SSB <- new %>% 
    mutate(mean = mean(percentRenew)) %>%
    group_by(region) %>% 
    mutate(groupmean = mean(percentRenew)) %>%
    summarize(SSB = sum((mean - groupmean)^2)) %>%
    summarize(sum(SSB)) %>%
    pull
  
  # Compute the F-statistic (ratio of MSB and MSW)
  # df for SSB is 4 groups - 1 = 3
  # df for SSW is 2805 observations - 4 groups = 2801
  (SSB/3)/(SSW/2801)
})

# Represent the distribution of the F-statistics for each randomized sample
hist(Fs, prob=T); abline(v = obs_F, col="red",add=T)

# Calculate the proportion of F statistic that are greater than the observed F-statistic
mean(Fs > obs_F)



```

From the above plot, it is clear to see that there is a significant difference in mean percentage renewable across regions
as the test statistic is far from the null distribution. This validates my earlier ANOVA results that showed percent renewable 
to have the most significant mean difference across the different regions.



Part 5: Linear Regression Model
```{r}

# Source: WS15

# Fit linear model and check assumptions
# Predict total renewable consumption solely based on amount of hydropower energy and wind

# Mean center hydropower and wind numeric variables
energyJoin$centerHydro <- energyJoin$Consumption.Commercial.Hydropower - mean(energyJoin$Consumption.Commercial.Hydropower, na.rm = TRUE)
energyJoin$centerWind <- energyJoin$Consumption.Commercial.Wind - mean(energyJoin$Consumption.Commercial.Wind, na.rm = TRUE)

# Wind and hydropower are the most used renewable resources in the US
# Fit two numeric variables and their interaction to predict total renewable energy
fit <- lm(renewableTotal ~ centerHydro + centerWind  + (centerHydro * centerWind), data = energyJoin)
summary(fit)

# Check assumptions:

# Residuals vs Fitted values plot
plot(fit, which = 1)

# Histogram of residuals
hist(fit$residuals)

# Q-Q plot for the residuals
plot(fit, which = 2)

### b. Normality
# Shapiro-Wilk test
# H0: normality
shapiro.test(fit$residuals)

# Kolmogorov-Smirnov test
# H0: normality
ks.test(fit$residuals, "pnorm", mean=0, sd(fit$residuals))
  

### c. Equal variance (homoscedasticity)
library(sandwich);
# Install a new package
# install.packages("lmtest")
library(lmtest)

# Breusch-Pagan test
# H0: homoscedasticity
bptest(fit) 

```
For my linear regression model, I first checked the assumptions of linearity, normality, and homoscedasity with a residuals v fitted values plot, qq-plot, and a bp test.
The linearity assumption does not appear to be met well as the graph does not show a straight line and has curves. The normality assumption appears to be mostly met
as the qq-plot is close to linear for a large portion. The homoscedasity,equal variance, assumption appears to be not met as the p-value of 0.5798 is high.


Part 5 continued:
```{r}

# Robust Standard Errors
coeftest(fit, vcov = vcovHC(fit))

# use bootstrap samples to estimate coefficients, SEs, fitted values, ...
# Example of estimating coefficients SEs
# Use the function replicate to repeat the process (similar to a for loop)
samp_SEs <- replicate(5000, {
  # Bootstrap your data (resample observations)
  boot_data <- sample_frac(energyJoin, replace = TRUE)
  # Fit regression model for two numeric
  fitboot <- lm(renewableTotal ~ centerHydro + centerWind  + (centerHydro * centerWind), data = energyJoin)
  # Save the coefficients
  coef(fitboot)
})

# Estimated SEs
samp_SEs %>%
  # Transpose the obtained matrices
  t %>%
  # Consider the matrix as a data frame
  as.data.frame %>%
  # Compute the standard error (standard deviation of the sampling distribution)
  summarize_all(sd)

# We can also consider a confidence interval for the estimates
samp_SEs %>%
  # Transpose the obtained matrices
  t %>%
  # Consider the matrix as a data frame
  as.data.frame %>%
  # Pivot longer to group by and summarize each coefficient
  pivot_longer(everything(), names_to = "estimates", values_to = "value") %>%
  group_by(estimates) %>%
  summarize(lower = quantile(value,.025), upper = quantile(value,.975))

# Compare this interval to original fit
confint(fit, level = 0.95)


```

From these assumptions, I built a linear model predicting percentage renewable energy based on the predictors of hydropower and wind energy consumption.
The coefficent estimates of 102.31 and -13.7 show that on average a 102.3 BTU increase in hydropower increases the renewable energy percentage by 1.
The coefficient of -13.7 shows that a -13.7 reduction in wind power would correspond to a 1 point increase in renewable energy percentage.
The relative coefficient of -3.27 means that a 1 BTU increase in hydropower corresponds to a -3.27 decrease in wind power consumption.
From the above data, it appears that 88.96% of the variation in the response variable is explained by the model.
After re-computing results using robust SEs, I found that bootstrapped standard error were less than the robust and original standard errors.
Thsi is further evidenced by the low p-values of < 2e-16 that result from the robust caluclation.
Futhermore, after comparing the confidence intervals it is easy to see that the robust calculation interrval is more accurate as it is narrower and more closely approximates the value of the test statistic.


Part 6: Logistic Regression
```{r}

# Source : WS16 + WS17

library(dplyr)
library(ggplot2)

# Create a binary variable coded as 0 and 1
# Use 1 if the percent renewable is greater than 5%, 0 otherwise
# Predict percent renewable based on wind and hydropower consumption (Response)

energyNew <- energyJoin %>% select(percentRenewable,Consumption.Commercial.Hydropower, Consumption.Commercial.Wind, region, Year, State) %>% mutate(binaryPercent = ifelse(percentRenewable >= 5, 1, 0)) 

# Consider a logistic model with the two numeric variables
# binaryPercent is categorical variable we are trying to predict
logisticFit <- glm(binaryPercent ~  + Consumption.Commercial.Hydropower + Consumption.Commercial.Wind, data = energyNew, family = "binomial")
summary(logisticFit)


# Based on predicted probabilities...
energyNew$prob1 <- predict(logisticFit, type = "response")

# Classify percent renewable as 1 or 0 based, if greater than 5% consider it good reliance on renewable energy (apply a cutoff of 0.5)
energyNew$predicted <- ifelse(energyNew$prob1 > .5, 1, 0)

# Confusion matrix
table(truth = energyNew$binaryPercent, prediction = energyNew$predicted)


# Plot density of log-odds by binary outcome variable (binaryPercent)
# Predicted log odds 
energyNew$logit <- predict(logisticFit, type = "link") 

# Density plot of log-odds for each outcome
energyNew %>%
  ggplot() + 
  geom_density(aes(logit, color = binaryPercent, fill = binaryPercent), alpha = .4) +
    geom_rug(aes(logit, color = binaryPercent)) +
  geom_text(x = -5, y = .07, label = "TN = 431") +
  geom_text(x = -1.75, y = .008, label = "FN = 19") +
  geom_text(x = 1, y = .006, label = "FP = 13") +
  geom_text(x = 5, y = .04, label = "TP = 220") +
  theme(legend.position = c(.85,.85)) +
  geom_vline(xintercept = 0) + 
  xlab("logit (log-odds)")


# Call the library plotROC
library(plotROC) 

# Plot ROC depending on values of y and its probabilities displaying some cutoff values
ROCplot1 <- ggplot(energyNew) + 
  geom_roc(aes(d = binaryPercent, m = prob1), cutoffs.at = list(0.1, 0.5, 0.9))
ROCplot1


# Calculate the area under the curve still using the library plotROC with function calc_auc
calc_auc(ROCplot1)
```

I built a logistic regression model predicting how large the perrcent renewable was (1 if > 5%) for each observation.
My explanatory variables here were the consumption of hydropowerr and wind energy.

Accuracy: (1676 + 58) / 2805 =  0.618
Sensisitvity:  58 / 1034 = 0.056
Specificity: 1676 / 1713 = 0.978
Precision: 58 / 95 = 0.611

These results mean 61.8% of cases were correctly classified,
5.6% of observations were true-positives, 97.8% of observations were true-negatives,
and 61.1% of observations were accurate true-positive predictions.

My computed AUC value of 0.522 as well as the ROC curve indicates that model is generally bad in creating predictions.
This stems from the interpration that a randomly selected observation from the greater than 5% (1 group) has a value 
larger than a randomly chosen observation from the less than 5% (0 group) 52.2% of the time.

From my above models and analysis, a key finding is that there is a significant difference in the total percentage of renewable energy across each of the 4 U.S regions.
This difference is also prevalent within the regions themselves indicating that not all states in a region have the same reliance on renewable power.
Another key finding I found is that consumption of hydropower and wind are generally good predictors of the total percentage renewable as a high percentage variation was explained with
their linear model.




